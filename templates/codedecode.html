<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Code / Decode</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
    body {
        font-size: 14px;
    }
    </style>
</head>
<body>
    <div class="container">
        <h1>Code / Decode</h1>
        <input id="input" type="text">
        <select name="operation" id="operation" onchange="dig()">
            <option value="MD5" selected>MD5 Hash</option>
            <option value="SHA-1" selected>SHA-1 Hash</option>
            <option value="base64-encode" selected>Base 64 encode</option>
            <option value="base64-decode" selected>Base 64 decode</option>
            <option value="url-encode" selected>URL Encode</option>
            <option value="url-decode" selected>URL Decode</option>
        </select>
        <button onclick="codedecode()">Submit</button>
        <p style="font-family: monospace;" id="response"></p>
    </div>
    <script>
        async function hash(message, hashType) {
            const msgBuffer = new TextEncoder('utf-8').encode(message)
            const hashBuffer = await crypto.subtle.digest(hashType, msgBuffer)
            const hashArray = Array.from(new Uint8Array(hashBuffer))
            const hashHex = hashArray.map(b => ('00' + b.toString(16)).slice(-2)).join('')

            return hashHex
        }
        function base64URLencode(str) {
            const utf8Arr = new TextEncoder().encode(str)
            const base64Encoded = btoa(utf8Arr)
            return base64Encoded.replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '')
        }
        function base64URLdecode(str) {
            const base64Encoded = str.replace(/-/g, '+').replace(/_/g, '/')
            const padding = str.length % 4 === 0 ? '' : '='.repeat(4 - (str.length % 4))
            const base64WithPadding = base64Encoded + padding
            return atob(base64WithPadding)
            .split('')
            .map(char => String.fromCharCode(char.charCodeAt(0)))
            .join('')
        }
        async function codedecode() {
            const input = document.getElementById("input").value
            const operation = document.getElementById("operation").value
            let output = ""
            if (operation === "MD5") {
                output = await hash(input, "MD5")
            }
            else if (operation === "SHA-1") {
                output = await hash(input, "SHA-1")
            }
            else if (operation === "base64-encode") {
                output = btoa(input)
            }
            else if (operation === "base64-decode") {
                output = atob(input)
            }
            else if (operation === "url-encode") {
                output = encodeURI(input)
            }
            else if (operation === "url-decode") {
                output = decodeURI(input)
            }
            else if (operation === "url-encode-64") {
                output = base64URLencode(input)
            }
            else if (operation === "url-decode-64") {
                output = base64URLdecode(input)
            }
            
            document.getElementById("response").innerText = output
        }
    </script>
</body>

</html>